<div class="photo-gallery-container">
    {% if photos %}
    <div class="photo-gallery">
        {% for photo in photos %}
        <div class="photo-item" id="photo-{{ photo.id }}">
            <img src="/{{ photo.file_path }}" alt="{{ photo.caption or 'Skate spot photo' }}" class="photo-thumbnail" />
            {% if photo.is_primary %}
            <span class="badge badge-primary">Primary</span>
            {% endif %}
            {% if photo.caption %}
            <div class="photo-caption">{{ photo.caption }}</div>
            {% endif %}
            {% if current_user and (current_user.id == photo.user_id or current_user.is_admin) %}
            <div class="photo-actions">
                {% if not photo.is_primary %}
                <button
                    hx-put="/api/v1/skate-spots/{{ spot_id }}/photos/{{ photo.id }}/primary"
                    hx-target="#photo-gallery-{{ spot_id }}"
                    hx-swap="outerHTML"
                    class="btn btn-sm btn-primary">
                    Set as Primary
                </button>
                {% endif %}
                <button
                    hx-delete="/api/v1/skate-spots/{{ spot_id }}/photos/{{ photo.id }}"
                    hx-confirm="Are you sure you want to delete this photo?"
                    hx-target="#photo-{{ photo.id }}"
                    hx-swap="outerHTML swap:0.5s"
                    class="btn btn-sm btn-danger">
                    Delete
                </button>
            </div>
            {% endif %}
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="no-photos-message">
        <p>No photos yet. Be the first to share a photo of this spot!</p>
    </div>
    {% endif %}

    {% if current_user %}
    <div class="photo-upload-section">
        <button
            id="upload-btn-{{ spot_id }}"
            hx-get="/skate-spots/{{ spot_id }}/photo-upload-form"
            hx-target="#upload-form-{{ spot_id }}"
            hx-swap="outerHTML"
            class="btn btn-primary">
            Upload Photo
        </button>
        <div id="upload-form-{{ spot_id }}"></div>
    </div>
    {% endif %}
</div>
