{% extends "base.html" %}

{% block title %}{{ profile.user.username }}'s Profile - Skate Spots{% endblock %}

{% block content %}
<div class="page-header">
    <h2>{{ profile.user.username }}'s Profile</h2>
    <p class="profile-subtitle">Member since {{ profile.user.created_at.strftime('%B %Y') }}</p>
</div>

<!-- Statistics Section -->
<div class="profile-stats">
    <h3>Activity Statistics</h3>
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-value">{{ profile.statistics.spots_added }}</div>
            <div class="stat-label">Spots Added</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">{{ profile.statistics.photos_uploaded }}</div>
            <div class="stat-label">Photos Uploaded</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">{{ profile.statistics.comments_posted }}</div>
            <div class="stat-label">Comments Posted</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">{{ profile.statistics.ratings_given }}</div>
            <div class="stat-label">Ratings Given</div>
        </div>
    </div>
</div>

<!-- Recent Activity Feed -->
{% if profile.activity.activities %}
<div class="activity-section">
    <h3>Recent Activity</h3>
    <div class="activity-feed">
        {% for activity in profile.activity.activities %}
        <div class="activity-item">
            <div class="activity-icon">
                {% if activity.activity_type == 'spot_created' %}üÜï
                {% elif activity.activity_type == 'photo_uploaded' %}üì∑
                {% elif activity.activity_type == 'comment_posted' %}üí¨
                {% elif activity.activity_type == 'rating_given' %}‚≠ê
                {% endif %}
            </div>
            <div class="activity-content">
                <div class="activity-text">
                    <strong>{{ activity.spot_name }}</strong> - {{ activity.details }}
                </div>
                <div class="activity-time">{{ activity.timestamp.strftime('%B %d, %Y at %I:%M %p') }}</div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}

<!-- Recent Spots -->
{% if profile.recent_spots %}
<div class="profile-section">
    <h3>Recent Spots Added</h3>
    <div class="spot-list">
        {% for spot in profile.recent_spots %}
            {% include "spot_card.html" %}
        {% endfor %}
    </div>
</div>
{% endif %}

<!-- Recent Comments -->
{% if profile.recent_comments %}
<div class="profile-section">
    <h3>Recent Comments</h3>
    <div class="comments-list">
        {% for comment in profile.recent_comments %}
        <div class="comment-preview">
            <div class="comment-content">{{ comment.content[:100] }}{% if comment.content|length > 100 %}...{% endif %}</div>
            <div class="comment-meta">On <strong>{{ comment.spot_id }}</strong> - {{ comment.created_at.strftime('%B %d, %Y') }}</div>
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}

<!-- Recent Ratings -->
{% if profile.recent_ratings %}
<div class="profile-section">
    <h3>Recent Ratings</h3>
    <div class="ratings-list">
        {% for rating in profile.recent_ratings %}
        <div class="rating-preview">
            <div class="rating-score">
                {% for i in range(rating.score) %}‚≠ê{% endfor %}
            </div>
            {% if rating.comment %}
            <div class="rating-comment">{{ rating.comment[:100] }}{% if rating.comment|length > 100 %}...{% endif %}</div>
            {% endif %}
            <div class="rating-meta">{{ rating.created_at.strftime('%B %d, %Y') }}</div>
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}

{% if not profile.recent_spots and not profile.recent_comments and not profile.recent_ratings %}
<div class="empty-state">
    <p>{{ profile.user.username }} hasn't added any content yet.</p>
</div>
{% endif %}

<style>
.profile-stats {
    margin: 2rem 0;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 1rem;
    margin-top: 1rem;
}

.stat-card {
    background: #f5f5f5;
    padding: 1.5rem;
    border-radius: 8px;
    text-align: center;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.stat-value {
    font-size: 2rem;
    font-weight: bold;
    color: #2563eb;
}

.stat-label {
    margin-top: 0.5rem;
    color: #666;
    font-size: 0.9rem;
}

.activity-section {
    margin: 2rem 0;
}

.activity-feed {
    margin-top: 1rem;
}

.activity-item {
    display: flex;
    align-items: start;
    padding: 1rem;
    border-bottom: 1px solid #e5e5e5;
}

.activity-item:last-child {
    border-bottom: none;
}

.activity-icon {
    font-size: 1.5rem;
    margin-right: 1rem;
}

.activity-content {
    flex: 1;
}

.activity-text {
    color: #333;
}

.activity-time {
    color: #666;
    font-size: 0.85rem;
    margin-top: 0.25rem;
}

.profile-section {
    margin: 2rem 0;
}

.profile-section h3 {
    margin-bottom: 1rem;
}

.comments-list, .ratings-list {
    display: grid;
    gap: 1rem;
}

.comment-preview, .rating-preview {
    background: #f9f9f9;
    padding: 1rem;
    border-radius: 8px;
    border-left: 3px solid #2563eb;
}

.comment-content, .rating-comment {
    color: #333;
    margin-bottom: 0.5rem;
}

.comment-meta, .rating-meta {
    color: #666;
    font-size: 0.85rem;
}

.rating-score {
    color: #f59e0b;
    margin-bottom: 0.5rem;
}

.profile-subtitle {
    color: #666;
    margin-top: 0.5rem;
}
</style>
{% endblock %}
